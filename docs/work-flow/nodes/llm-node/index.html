<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-work-flow/nodes/llm-node" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">LLM Node | LAYRA</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://liweiphys.github.io/layra/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://liweiphys.github.io/layra/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://liweiphys.github.io/layra/docs/work-flow/nodes/llm-node"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="LLM Node | LAYRA"><meta data-rh="true" name="description" content="The LLM Node is the core component for integrating large language models into your workflows. It provides flexible interfaces to configure system prompts, inputs, and outputs while enabling seamless interaction with global variables, knowledge bases (RAG), external function calls (including MCP), and other advanced features."><meta data-rh="true" property="og:description" content="The LLM Node is the core component for integrating large language models into your workflows. It provides flexible interfaces to configure system prompts, inputs, and outputs while enabling seamless interaction with global variables, knowledge bases (RAG), external function calls (including MCP), and other advanced features."><link data-rh="true" rel="icon" href="/layra/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://liweiphys.github.io/layra/docs/work-flow/nodes/llm-node"><link data-rh="true" rel="alternate" href="https://liweiphys.github.io/layra/docs/work-flow/nodes/llm-node" hreflang="en"><link data-rh="true" rel="alternate" href="https://liweiphys.github.io/layra/docs/work-flow/nodes/llm-node" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Workflow","item":"https://liweiphys.github.io/layra/docs/category/workflow"},{"@type":"ListItem","position":2,"name":"Nodes","item":"https://liweiphys.github.io/layra/docs/category/nodes"},{"@type":"ListItem","position":3,"name":"LLM Node","item":"https://liweiphys.github.io/layra/docs/work-flow/nodes/llm-node"}]}</script><link rel="alternate" type="application/rss+xml" href="/layra/blog/rss.xml" title="LAYRA RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/layra/blog/atom.xml" title="LAYRA Atom Feed"><link rel="stylesheet" href="/layra/assets/css/styles.3dbcda49.css">
<script src="/layra/assets/js/runtime~main.1a633d33.js" defer="defer"></script>
<script src="/layra/assets/js/main.d198638f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/layra/img/logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/layra/"><div class="navbar__logo"><img src="/layra/img/logo.png" alt="LAYRA Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/layra/img/logo.png" alt="LAYRA Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">LAYRA</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/layra/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/layra/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/liweiphys/layra" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/layra/docs/intro">Quick Start</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/layra/docs/knowledge-base">Knowledge Base</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/layra/docs/RAG-Chat">RAG-Chat</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/layra/docs/category/workflow">Workflow</a><button aria-label="Collapse sidebar category &#x27;Workflow&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/layra/docs/work-flow/basic-concept">Basic Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/layra/docs/category/nodes">Nodes</a><button aria-label="Collapse sidebar category &#x27;Nodes&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/layra/docs/work-flow/nodes/node-intro">Node Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/layra/docs/work-flow/nodes/start-node">Start Node</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/layra/docs/work-flow/nodes/condition-node">Condition Node</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/layra/docs/work-flow/nodes/loop-node">Loop Node</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/layra/docs/work-flow/nodes/code-node">Code Node</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/layra/docs/work-flow/nodes/llm-node">LLM Node</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/layra/docs/work-flow/workflow">Workflow Operations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/layra/docs/work-flow/template-gallery">Template Gallery</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/layra/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/layra/docs/category/workflow"><span>Workflow</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/layra/docs/category/nodes"><span>Nodes</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">LLM Node</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>LLM Node</h1></header>
<p>The LLM Node is the core component for integrating large language models into your workflows. It provides flexible interfaces to configure system prompts, inputs, and outputs while enabling seamless interaction with global variables, knowledge bases (RAG), external function calls (including MCP), and other advanced features.</p>
<p><img decoding="async" loading="lazy" alt="LLM Node Interface" src="/layra/assets/images/llm-node-7c5b9a3af82d4cbc0aef45a78ee517a1.png" width="3024" height="1964" class="img_ev3q"></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="core-configuration-sections">Core Configuration Sections<a href="#core-configuration-sections" class="hash-link" aria-label="Direct link to Core Configuration Sections" title="Direct link to Core Configuration Sections">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-prompt-configuration">1. Prompt Configuration<a href="#1-prompt-configuration" class="hash-link" aria-label="Direct link to 1. Prompt Configuration" title="Direct link to 1. Prompt Configuration">​</a></h3>
<p>Defines the system prompt guiding the LLM&#x27;s behavior. Supports dynamic variable insertion using <code>{{variable}}</code> syntax.</p>
<ul>
<li><strong>Format</strong>: Plain text with optional variable placeholders</li>
<li><strong>Variable Handling</strong>: Automatically replaces <code>{{variable}}</code> with values from <strong>Global Variables</strong></li>
<li><strong>Advanced Settings</strong> (via <strong>More Settings</strong>):<!-- -->
<ul>
<li>Model selection</li>
<li>LLM parameters (temperature, max tokens, top-P, etc.)</li>
<li>Knowledge base RAG integration<br>
<em>Refer to <a href="/layra/docs/RAG-Chat">RAG-Chat</a> for implementation details.</em></li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-input-configuration">2. Input Configuration<a href="#2-input-configuration" class="hash-link" aria-label="Direct link to 2. Input Configuration" title="Direct link to 2. Input Configuration">​</a></h3>
<p>Determines the LLM&#x27;s input source with two operational modes:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="predefined-input">Predefined Input<a href="#predefined-input" class="hash-link" aria-label="Direct link to Predefined Input" title="Direct link to Predefined Input">​</a></h4>
<ul>
<li>Fixed input defined during workflow design</li>
<li>Supports <code>{{variable}}</code> syntax for <strong>Global Variables</strong></li>
<li>Executes workflow without user interruption</li>
<li>Activated via <code>Change Input Style</code></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="chatflow-user-input">ChatFlow User Input<a href="#chatflow-user-input" class="hash-link" aria-label="Direct link to ChatFlow User Input" title="Direct link to ChatFlow User Input">​</a></h4>
<ul>
<li>Pauses workflow execution at this node</li>
<li>Presents interactive dialog for real-time user input <strong>(Human-In-The-Loop)</strong></li>
<li>Activated via <code>Change Input Style</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-llm-response">3. LLM Response<a href="#3-llm-response" class="hash-link" aria-label="Direct link to 3. LLM Response" title="Direct link to 3. LLM Response">​</a></h3>
<p>Processes and displays model outputs with these features:</p>
<ul>
<li><strong>Markdown Rendering</strong>: Formatted display including URL/base64 images</li>
<li><strong>JSON Extraction</strong>:
Automatically detects and extracts JSON objects using regex. Supports multiple JSON structures in outputs. Valid JSON pairs with <strong>Global Variables</strong> for assignment.<!-- -->
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Example</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;variable&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;value&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> → Updates </span><span class="token keyword" style="color:#00009f">global</span><span class="token plain"> variable</span><br></span></code></pre></div></div>
</li>
<li><strong>Run Test</strong>: Execute node independently</li>
<li><strong>Response Assignment</strong>:<!-- -->
<ul>
<li>Dropdown lists all <em>Global Variables</em></li>
<li>Assigns full response to selected variable<br>
<em>Works parallel with <strong>JSON Extraction</strong></em></li>
</ul>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Variable Replacement Example" src="/layra/assets/images/llm-variable-replacement-8ef8f8635bf4030a8090a7b3b59cb31e.png" width="3024" height="1964" class="img_ev3q"></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-chatflow-controls">4. ChatFlow Controls<a href="#4-chatflow-controls" class="hash-link" aria-label="Direct link to 4. ChatFlow Controls" title="Direct link to 4. ChatFlow Controls">​</a></h3>
<p><strong>The ChatFlow module is essential in LAYRA workflows</strong>, enabling you to interrupt execution at any point for manual input (e.g., activating <code>human-in-the-loop</code> for intervention) while selectively displaying LLM outputs and hiding backend processes such as reasoning or text handling.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="three-checkboxes-governing-conversation-flow">Three checkboxes governing conversation flow:<a href="#three-checkboxes-governing-conversation-flow" class="hash-link" aria-label="Direct link to Three checkboxes governing conversation flow:" title="Direct link to Three checkboxes governing conversation flow:">​</a></h4>
<table><thead><tr><th>Checkbox</th><th>Function</th><th>Dependencies</th></tr></thead><tbody><tr><td><strong>Set As Chatflow User Input</strong></td><td>Marks node as user input</td><td>Auto-enables user input mode</td></tr><tr><td><strong>Set As Chatflow AI Response</strong></td><td>Marks node as AI output</td><td>Required for Memory feature</td></tr><tr><td><strong>Use Conversation Memory</strong></td><td>Maintains chat history</td><td>Requires AI Response checkbox</td></tr></tbody></table>
<p>When enabling <code>User Input</code>, <code>AI Response</code>, <code>Conversation Memory</code>, or <code>MCP Support</code>, corresponding icons appear on canvas nodes.</p>
<ul>
<li>
<p><strong>User Input Nodes</strong>:<br>
<!-- -->Enable <code>User Input</code> to pause workflow execution and display an interactive input dialog in ChatFlow. Nodes with <code>Predefined Input</code> run in the background using preset values. View detailed input/output via the node&#x27;s <code>LLM Response</code> and <code>Output</code> panels.</p>
</li>
<li>
<p><strong>AI Response Nodes</strong>:<br>
<!-- -->Enable <code>AI Response</code> to display model outputs in the ChatFlow dialog. Disabled nodes run in the background – check <code>LLM Response</code> and <code>Output</code> panels for details.</p>
</li>
<li>
<p><strong>Conversation Memory</strong>:<br>
<!-- -->Enable to retain chat history across sessions. Disabling treats each <code>User Input</code> as a new conversation.</p>
</li>
</ul>
<blockquote>
<p>Access historical ChatFlow runs via the top-right <code>Chatflow History</code> button. This only includes conversations where <code>User Input</code>/<code>AI Response</code> features were enabled.</p>
</blockquote>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>CHATFLOW LOGIC</div><div class="admonitionContent_BuS1"><p>Each <code>User Input</code> node must be followed by a corresponding <code>AI Response</code> node to maintain conversational flow. The system will flag errors for:</p><ul>
<li>Consecutive <code>User Input</code> nodes</li>
<li>Consecutive <code>AI Response</code> nodes</li>
</ul></div></div>
<p><img decoding="async" loading="lazy" alt="Chat Flow" src="/layra/assets/images/llm-chatflow-fbcb370869d230ccd887c8466a2a6ad0.png" width="3024" height="1964" class="img_ev3q"></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-mcp-support">5. MCP Support<a href="#5-mcp-support" class="hash-link" aria-label="Direct link to 5. MCP Support" title="Direct link to 5. MCP Support">​</a></h3>
<p>Click the <code>MCP Tools</code> button in the top-right corner of the ChatFlow configuration panel to set up MCP servers. LAYRA supports SSE-streaming MCP services with simple configuration:</p>
<ol>
<li>Enter <code>MCP Name</code> and click <code>Click to Add</code> to create server</li>
<li>Input SSE endpoint URL in <code>MCP Server Url</code></li>
<li>Use <code>Refresh Tools</code> to load available tools</li>
<li>Activate services:<!-- -->
<ul>
<li>Toggle <code>Use This MCP Tools</code> for full service activation</li>
<li>Check <code>Use Function Tool</code> per tool for granular control</li>
</ul>
</li>
</ol>
<p>Once activated, LLMs automatically invoke tools during conversations. Multiple MCP servers can be configured per LLM node.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>RECOMMENDATION</div><div class="admonitionContent_BuS1"><p>We recommend disabling the LLM&#x27;s <code>thinking mode</code> when using MCP, as the backend activates built-in reasoning modules during tool invocation.</p></div></div>
<p><img decoding="async" loading="lazy" alt="LLM Node MCP" src="/layra/assets/images/llm-mcp-4ce5cf6274748ec0cef9517190d996e4.png" width="3024" height="1964" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>MCP SERVER LOCAL DEPLOYMENT NOTE</div><div class="admonitionContent_BuS1"><p><strong>When using a locally hosted MCP server:</strong></p><ol>
<li>Set the <code>MCP Server Url</code> to your machine&#x27;s <strong>Internal IP Address</strong> (e.g., <code>http://192.168.1.5:8000/sse</code> or <code>http://10.0.0.2:5000/sse</code>), <strong>not</strong> <code>localhost:5000/sse</code>.</li>
<li><strong>Firewall Configuration:</strong> If you&#x27;re using a firewall (e.g., <code>ufw</code>), allow Docker network access <strong>to</strong> your MCP server port.</li>
<li><strong>Service Binding:</strong> Ensure your MCP service <strong>binds to <code>0.0.0.0</code></strong> (all interfaces), <strong>not</strong> <code>127.0.0.1</code> (localhost only).</li>
</ol></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-mcp-advanced-settings">6. MCP Advanced Settings<a href="#6-mcp-advanced-settings" class="hash-link" aria-label="Direct link to 6. MCP Advanced Settings" title="Direct link to 6. MCP Advanced Settings">​</a></h3>
<p>You can also configure <code>Headers</code> and <code>Timeout Settings</code> in <strong>Advanced Settings</strong>. For instance, enabling LLM nodes to access <strong>RAGFLOW</strong>&#x27;s external knowledge base requires configuring the <code>api_key</code> in the headers.</p>
<p><img decoding="async" loading="lazy" alt="LLM Node MCP Advanced Settings" src="/layra/assets/images/llm-mcp-advanced-1220f3955e15d875a5cccc5ea47a5495.png" width="3024" height="1964" class="img_ev3q"></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="chatflow-mechanics">ChatFlow Mechanics<a href="#chatflow-mechanics" class="hash-link" aria-label="Direct link to ChatFlow Mechanics" title="Direct link to ChatFlow Mechanics">​</a></h2>
<p>We demonstrate ChatFlow Mechanics through a simple workflow containing three LLM nodes:</p>
<ol>
<li>The first LLM node handles user input</li>
<li>The second translates the first node&#x27;s English output into Chinese</li>
<li>The third node outputs the second node&#x27;s Chinese translation</li>
</ol>
<p>In the ChatFlow interface, only the user&#x27;s English input and final Chinese output are visible. The first node&#x27;s output, third node&#x27;s input, and the entire second node operate in the background.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-chatflow-example">Basic ChatFlow Example<a href="#basic-chatflow-example" class="hash-link" aria-label="Direct link to Basic ChatFlow Example" title="Direct link to Basic ChatFlow Example">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Basic ChatFlow Mermaid" src="/layra/assets/images/basic-chatflow-dc8d9bc7ae25a1f693b82edaff17dff9.png" width="2034" height="414" class="img_ev3q"></p>
<ul>
<li>Only input/output nodes appear in the ChatFlow UI</li>
<li>Intermediate processing remains hidden</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="conversation-memory-setup">Conversation Memory Setup<a href="#conversation-memory-setup" class="hash-link" aria-label="Direct link to Conversation Memory Setup" title="Direct link to Conversation Memory Setup">​</a></h3>
<ul>
<li>
<p><strong>Requirements</strong>:</p>
<ul>
<li>Paired input/output nodes</li>
<li>&quot;Use Conversation Memory&quot; enabled on output nodes</li>
</ul>
</li>
<li>
<p><strong>Validation</strong>:</p>
<ul>
<li>Blocks consecutive input nodes</li>
<li>Prevents orphaned output nodes</li>
</ul>
</li>
</ul>
<p>This example also has the memory feature enabled:</p>
<p><img decoding="async" loading="lazy" alt="Basic ChatFlow Example" src="/layra/assets/images/basic-chatflow-example-60a22d1def0cfff5fcdb0f72d1df4a6a.png" width="3024" height="1964" class="img_ev3q"></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="variable-configuration-guide">Variable Configuration Guide<a href="#variable-configuration-guide" class="hash-link" aria-label="Direct link to Variable Configuration Guide" title="Direct link to Variable Configuration Guide">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-basic-prompt-with-variables">1. Basic Prompt with Variables<a href="#1-basic-prompt-with-variables" class="hash-link" aria-label="Direct link to 1. Basic Prompt with Variables" title="Direct link to 1. Basic Prompt with Variables">​</a></h3>
<ol>
<li>Create global variable: <code>topic = &quot;climate change&quot;</code></li>
<li>Configure prompt:<!-- -->
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">As a science expert, explain {{topic}} in simple terms.</span><br></span></code></pre></div></div>
</li>
<li>Set input style: <strong>Predefined Input</strong> (<code>What are key impacts?</code>)</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-interactive-user-input">2. Interactive User Input<a href="#2-interactive-user-input" class="hash-link" aria-label="Direct link to 2. Interactive User Input" title="Direct link to 2. Interactive User Input">​</a></h3>
<ol>
<li>Enable <strong>Set As Chatflow User Input</strong></li>
<li>Configure prompt:<!-- -->
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">As a travel assistant, always provide helpful responses.</span><br></span></code></pre></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-output-capture-methods">3. Output Capture Methods<a href="#3-output-capture-methods" class="hash-link" aria-label="Direct link to 3. Output Capture Methods" title="Direct link to 3. Output Capture Methods">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="31-json-output-processing">3.1 JSON Output Processing<a href="#31-json-output-processing" class="hash-link" aria-label="Direct link to 3.1 JSON Output Processing" title="Direct link to 3.1 JSON Output Processing">​</a></h4>
<ol>
<li>Prompt configuration:<!-- -->
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Output JSON</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">destination</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> duration</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> budget</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Example</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;destination&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Paris&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;duration&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;budget&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2500</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li>LLM output:<!-- -->
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;destination&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Kyoto&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;duration&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;budget&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3200</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li>Automatically updates variables in <strong>Global Variables</strong>:<!-- -->
<ul>
<li><code>destination = &quot;Kyoto&quot;</code></li>
<li><code>duration = 10</code></li>
<li><code>budget = 3200</code></li>
</ul>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="32-manual-assignment">3.2 Manual Assignment<a href="#32-manual-assignment" class="hash-link" aria-label="Direct link to 3.2 Manual Assignment" title="Direct link to 3.2 Manual Assignment">​</a></h4>
<p>Select variable in <code>LLM Response=</code> dropdown → Full response stored</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Error Prevention</div><div class="admonitionContent_BuS1"><ul>
<li>⚠️ <strong>&quot;Consecutive input nodes without output&quot;</strong></li>
<li>⚠️ <strong>&quot;Output node without preceding input&quot;</strong></li>
<li>⚠️ <strong>&quot;Memory enabled without AI Response designation&quot;</strong></li>
<li>⚠️ <strong>&quot;Using <code>Predefined Input</code> without defining content&quot;</strong></li>
</ul></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="implementation-example-web-scraping--email-automation">Implementation Example: Web Scraping + Email Automation<a href="#implementation-example-web-scraping--email-automation" class="hash-link" aria-label="Direct link to Implementation Example: Web Scraping + Email Automation" title="Direct link to Implementation Example: Web Scraping + Email Automation">​</a></h2>
<p>Let’s walk through a practical example of combining <strong>LLM nodes</strong> with <strong>code nodes</strong> in a workflow to create a simple automation: scraping quotes from a website, filtering them by a user-specified theme using a large language model, and sending the selected quotes via email.</p>
<p>This example involves <strong>four functional nodes</strong> plus an additional <code>code</code> node to install required pip dependencies.</p>
<p>In this workflow, there is a single human intervention step: specifying the desired quote theme before the LLM generates the email content. Therefore:</p>
<ul>
<li>The <strong>email generation node</strong> needs to enable the <code>User Input</code> feature.</li>
<li>Before that, we add a <code>code</code> node to scrape a large number of quotes for the LLM to filter.</li>
<li>After the LLM processes the data, another <code>code</code> node sends the email.</li>
<li>Finally, we add an LLM output node with <code>AI Response</code> enabled at the end of the workflow to display the sent email content directly in the Chatflow for improved user experience.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Email Global Variable" src="/layra/assets/images/email-global-variable-c6cfea549a6ed7a8570d0150cb9f8080.png" width="3024" height="1964" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-global-variable-configuration">1. Global Variable Configuration<a href="#1-global-variable-configuration" class="hash-link" aria-label="Direct link to 1. Global Variable Configuration" title="Direct link to 1. Global Variable Configuration">​</a></h3>
<p>As shown above, first define all necessary <strong>Global Variables</strong>:</p>
<p>Before proceeding, you must authorize LAYRA to send emails using an <code>Authorization Code</code>. Refer to the <a href="/layra/docs/work-flow/nodes/code-node">Code Node Section</a> for instructions, or ask the LLM directly for guidance.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">quotes_url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://quotes.toscrape.com&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># The website to scrape quotes from</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quotes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Initially empty; will be populated by the scraping node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">recipient_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Your Name&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Replace with the recipient&#x27;s name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">recipient_email </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;recipient@example.com&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Replace with the recipient&#x27;s email</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sender_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;LAYRA&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Replace with the sender&#x27;s name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sender_email </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sender@example.com&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Replace with the sender&#x27;s email</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">authorization_code </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Your Code&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Replace with the sender&#x27;s Authorization Code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">email_subject </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Initially empty; generated by the LLM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">email_body </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Initially empty; generated by the LLM</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Best Practice</div><div class="admonitionContent_BuS1"><p>Often, you do not need to define all <code>Global Variables</code> at the start. Instead, add or remove variables as your workflow logic evolves.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-node-configuration">2. Node Configuration<a href="#2-node-configuration" class="hash-link" aria-label="Direct link to 2. Node Configuration" title="Direct link to 2. Node Configuration">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-pip-dependencies-node">1. Pip Dependencies Node<a href="#1-pip-dependencies-node" class="hash-link" aria-label="Direct link to 1. Pip Dependencies Node" title="Direct link to 1. Pip Dependencies Node">​</a></h4>
<p>Modify the <code>Pip Dependencies</code> field to include:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">beautifulsoup4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">requests </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.26</span><span class="token number" style="color:#36acaa">.0</span><br></span></code></pre></div></div>
<p>If you are located in China and need to accelerate downloads, set a pip mirror:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Mirror Url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">//</span><span class="token plain">pypi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tuna</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tsinghua</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">edu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cn</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">simple</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Email Pip Node" src="/layra/assets/images/email-pip-node-a70614d82cbe2ade5fdc1621340e2fd3.png" width="3024" height="1964" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Persisting Mirrors</div><div class="admonitionContent_BuS1"><p>Check <code>Commit Runtime Environment</code> to persist your pip mirror and dependencies, avoiding the need for a separate pip installation node in future runs.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-web-scraping-node">2. Web Scraping Node<a href="#2-web-scraping-node" class="hash-link" aria-label="Direct link to 2. Web Scraping Node" title="Direct link to 2. Web Scraping Node">​</a></h4>
<p>Replace the <code>Code Editor</code> content with the following code. This script scrapes <strong>only the first two pages</strong>, accepts <code>quotes_url</code> as input, and stores the scraped quotes into the <code>quotes</code> variable:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> bs4 </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> BeautifulSoup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">scrape_quotes_toscrape</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">base_url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    scraped_quotes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Scrape only the first two pages</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> page_num </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">base_url</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">/page/</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">page_num</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">/&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Scraping page </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">page_num</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">url</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">  &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Send HTTP request</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Check response status</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">status_code </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Failed to scrape page </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">page_num</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">. Status code: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">response</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">status_code</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">  &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Parse HTML content</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        soup </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> BeautifulSoup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;html.parser&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Find all quote blocks</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        quotes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> soup</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;div.quote&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Extract information from each quote</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> quote </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> quotes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> quote</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">select_one</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;span.text&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            author </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> quote</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">select_one</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;small.author&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">tag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> tag </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> quote</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;a.tag&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            scraped_quotes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&#x27;quote&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&#x27;author&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> author</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&#x27;tags&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tags</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&#x27;page&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> page_num</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Page </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">page_num</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> scraped successfully. Found </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">quotes</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> quotes\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Print summary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Total quotes scraped: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">scraped_quotes</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">  &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> scraped_quotes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Function execution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quotes_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> scrape_quotes_toscrape</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">quotes_url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> item </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">enumerate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">quotes_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    quotes </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&gt; </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">. </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">item</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;quote&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">  \n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    quotes </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;   - **Author**: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">item</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;author&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">  \n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    quotes </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;   - **Tags**: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;, &#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">join</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">item</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;tags&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">  \n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    quotes </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;   - **Page**: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">item</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;page&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">\n  &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Display sample output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\n### Sample quotes:  &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> item </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">enumerate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">quotes_data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&gt; </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">. </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">item</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;quote&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">  &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;   - **Author**: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">item</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;author&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">  &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;   - **Tags**: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;, &#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">join</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">item</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;tags&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">  &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;   - **Page**: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">item</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;page&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">\n  &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Email Scraping Node" src="/layra/assets/images/email-scraping-node-8c43fee3cf26251fdba136e983ece77b.png" width="3024" height="1964" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-user-input--email-generation-node">3. User Input &amp; Email Generation Node<a href="#3-user-input--email-generation-node" class="hash-link" aria-label="Direct link to 3. User Input &amp; Email Generation Node" title="Direct link to 3. User Input &amp; Email Generation Node">​</a></h4>
<p>Set the LLM prompt to:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Based on the user&#x27;s requirements, select some appropriate short quotes and output them as an email in JSON format only. Do not include any other information. The output format should be: {&quot;email_subject&quot;: email_subject_output, &quot;email_body&quot;: email_body_output}. The recipient is: {{recipient_name}}, and the sender is: {{sender_name}}.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Here are all the quotes information:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{{quotes}}</span><br></span></code></pre></div></div>
<p>This ensures the LLM outputs a valid JSON containing <code>email_subject</code> and <code>email_body</code>, which LAYRA will parse and assign to the corresponding <strong>Global Variables</strong>.</p>
<p><strong>Important:</strong> Enable <code>Use Chatflow User Input</code> by checking the <code>Set As Chatflow User Input</code> box to accept user input in this node.</p>
<p><img decoding="async" loading="lazy" alt="Email Input Node" src="/layra/assets/images/email-input-node-d7af35ef1a45d0de96405e702142f5ea.png" width="3024" height="1964" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-email-sending-node">4. Email Sending Node<a href="#4-email-sending-node" class="hash-link" aria-label="Direct link to 4. Email Sending Node" title="Direct link to 4. Email Sending Node">​</a></h4>
<p>Replace the <code>Code Editor</code> content with the following code to send the generated email using the specified SMTP server.</p>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>SMTP Server Configuration</div><div class="admonitionContent_BuS1"><p>Replace the SMTP server address with your own provider. The example below uses Foxmail.</p></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> smtplib</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> traceback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> email</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> MIMEText</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> email</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">multipart </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> MIMEMultipart</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> email</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">utils </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> formatdate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">send_email</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># ===== Email Content Setup =====</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        msg </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> MIMEMultipart</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        msg</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;From&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sender_email  </span><span class="token comment" style="color:#999988;font-style:italic"># Replace with sender email</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        msg</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;To&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> recipient_email  </span><span class="token comment" style="color:#999988;font-style:italic"># Replace with recipient email</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        msg</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Subject&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> email_subject  </span><span class="token comment" style="color:#999988;font-style:italic"># Updated subject</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        msg</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Date&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> formatdate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">localtime</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Add date header</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Add email body</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        body </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> MIMEText</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">email_body</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;plain&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;utf-8&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Updated content</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">attach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># ===== Establish SSL Connection =====</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        server </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> smtplib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SMTP_SSL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;smtp.qq.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">465</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Replace with SMTP server</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">login</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sender_email</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> authorization_code</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Use authorization code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Send email</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendmail</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;From&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;To&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">as_string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Email sent successfully&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Email sending failed: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Exception traceback:\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> traceback</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">format_exc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">finally</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Safely close connection, ignore quit errors</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">quit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Attempt graceful quit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> smtplib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SMTPServerDisconnected</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># Server already disconnected, no action needed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Non-critical error during connection close: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Execute email sending</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">send_email</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Email Scraping Node" src="/layra/assets/images/email-scraping-node-8c43fee3cf26251fdba136e983ece77b.png" width="3024" height="1964" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-llm-output-node">5. LLM Output Node<a href="#5-llm-output-node" class="hash-link" aria-label="Direct link to 5. LLM Output Node" title="Direct link to 5. LLM Output Node">​</a></h4>
<p>This final node simply displays the generated email body to the user.</p>
<p>Set <code>Predefined Input</code> to:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Output the following content exactly, without including anything else and without any processing:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{{email_body}}</span><br></span></code></pre></div></div>
<p>Ensure <code>Set As Chatflow AI Response</code> is checked so Chatflow displays the email content properly.</p>
<p><img decoding="async" loading="lazy" alt="Email Output Node" src="/layra/assets/images/email-output-node-45dfc20393b661553f5ccc91ccef70e4.png" width="3024" height="1964" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-running-the-workflow">3. Running the Workflow<a href="#3-running-the-workflow" class="hash-link" aria-label="Direct link to 3. Running the Workflow" title="Direct link to 3. Running the Workflow">​</a></h3>
<p>Now click <strong>Run</strong> to execute your workflow. In the Chatflow input box, enter a command like:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Send an email on the theme of &#x27;inspirational&#x27;</span><br></span></code></pre></div></div>
<p>If everything works correctly, your recipient will receive an inspirational email crafted by LAYRA. May these small automations bring you motivation and energy in your daily learning and work.</p>
<p><img decoding="async" loading="lazy" alt="Email Screenshot" src="/layra/assets/images/email-screenshot-907e8047aa96b8a139a250f9885c495e.png" width="1985" height="859" class="img_ev3q"></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next Steps<a href="#next-steps" class="hash-link" aria-label="Direct link to Next Steps" title="Direct link to Next Steps">​</a></h2>
<p>You have now mastered how to use all node types in your workflows. The final chapter will cover workflow management features including <strong>debugging, import/export, and more</strong>. You’re almost at the finish line – keep moving forward!</p>
<blockquote>
<p><strong>Coming Soon</strong>: Explore the <a href="/layra/docs/work-flow/template-gallery">Template Gallery</a> for prebuilt automation solutions!</p>
</blockquote></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/layra/docs/work-flow/nodes/code-node"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Code Node</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/layra/docs/work-flow/workflow"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Workflow Operations</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#core-configuration-sections" class="table-of-contents__link toc-highlight">Core Configuration Sections</a><ul><li><a href="#1-prompt-configuration" class="table-of-contents__link toc-highlight">1. Prompt Configuration</a></li><li><a href="#2-input-configuration" class="table-of-contents__link toc-highlight">2. Input Configuration</a></li><li><a href="#3-llm-response" class="table-of-contents__link toc-highlight">3. LLM Response</a></li><li><a href="#4-chatflow-controls" class="table-of-contents__link toc-highlight">4. ChatFlow Controls</a></li><li><a href="#5-mcp-support" class="table-of-contents__link toc-highlight">5. MCP Support</a></li><li><a href="#6-mcp-advanced-settings" class="table-of-contents__link toc-highlight">6. MCP Advanced Settings</a></li></ul></li><li><a href="#chatflow-mechanics" class="table-of-contents__link toc-highlight">ChatFlow Mechanics</a><ul><li><a href="#basic-chatflow-example" class="table-of-contents__link toc-highlight">Basic ChatFlow Example</a></li><li><a href="#conversation-memory-setup" class="table-of-contents__link toc-highlight">Conversation Memory Setup</a></li></ul></li><li><a href="#variable-configuration-guide" class="table-of-contents__link toc-highlight">Variable Configuration Guide</a><ul><li><a href="#1-basic-prompt-with-variables" class="table-of-contents__link toc-highlight">1. Basic Prompt with Variables</a></li><li><a href="#2-interactive-user-input" class="table-of-contents__link toc-highlight">2. Interactive User Input</a></li><li><a href="#3-output-capture-methods" class="table-of-contents__link toc-highlight">3. Output Capture Methods</a></li></ul></li><li><a href="#implementation-example-web-scraping--email-automation" class="table-of-contents__link toc-highlight">Implementation Example: Web Scraping + Email Automation</a><ul><li><a href="#1-global-variable-configuration" class="table-of-contents__link toc-highlight">1. Global Variable Configuration</a></li><li><a href="#2-node-configuration" class="table-of-contents__link toc-highlight">2. Node Configuration</a></li><li><a href="#3-running-the-workflow" class="table-of-contents__link toc-highlight">3. Running the Workflow</a></li></ul></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next Steps</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/layra/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.bilibili.com/video/BV1sd7QzmEUg/?share_source=copy_web" target="_blank" rel="noopener noreferrer" class="footer__link-item">B站视频介绍<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/liweiphys/layra/blob/main/assets/WechatOfficialAccount.jpg" target="_blank" rel="noopener noreferrer" class="footer__link-item">微信公众号<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/liweiphys/layra/blob/main/assets/Wechat-group1.jpg" target="_blank" rel="noopener noreferrer" class="footer__link-item">微信群<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/layra/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/liweiphys/layra" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 LAYRA, Wei Li(李威). Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>